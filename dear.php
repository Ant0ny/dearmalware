<!--
/**
 * First aid antivisruses scanner fot site owners - DearMalWare
 * URI: https://github.com/Ant0ny/dearmalware
 * Author: Anton Bannikov
 * This is the index file of scanner!
 */
-->
<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>First aid antivisruses scanner fot site owners - DearMalWare</title>
</head>

<body>
	<h1>The site scanner of Malicious dangerous php code - DearMalWare</h1>
	<div class="progress_line"><img alt="" src="./dear_loader.gif"></div>
	<div class="status_line"></div>
	<div class="output"></div>

	<script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>
	<script>
		jQuery(function($) {

			$(".progress_line img").show();

			$(".status_line").html("<p><strong>Getting directories structure.</strong></p>").show();

			var data = {
				action: "get_structure"
			};

			$.ajax({
				method: "POST",
				url: './dear_ajax_scanner.php',
				data: data,
				success: function(res) {
					if (res != undefined) {
						$(".progress_line img").hide();
						$(".status_line").append("<p><strong>We've got directories structure...<span class=\"green\">OK</span></strong></p>");

						$(".output").html(res.whatfound);
					}
				},
			}).then(function() {
				var data = {
					action: "check_viruses"
				};

				$(".progress_line img").show();

				$(".status_line").append("<p><strong>Scanning text content files for viruses.</strong></p>").show();

				$.ajax({
					method: "POST",
					url: './dear_ajax_scanner.php',
					data: data,
					success: function(res2) {
						if (res2 != undefined) {
							$(".progress_line img").hide();

							if (res2.isfound != undefined && res2.isfound == true)
								$(".status_line").append("<p><strong>All files have been scanned up. We've found a dangerous code...<span class=\"red\">Warning</span></strong></p>");
							if (res2.isfound != undefined && res2.isfound == false)
								$(".status_line").append("<p><strong>All files have been scanned up, There's no dangerous code...<span class=\"green\">ОК</span></strong></p>");
							$(".output").append(res2.whatfound);
						}
					}
				});
			});
		});
	</script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
	<style>
		body {
			margin: 10px;
		}

		.progress_line img {
			display: none;
		}

		.status_line {
			display: none;
		}

		.red {
			color: #FF0000;
		}

		.yellow {
			color: #ced22c;
		}

		.green {
			color: green;
		}

		button {
			margin: 10px 0;
		}

		.found_issues {
			border: 1px dotted #FF0000;
		}

		.file {
			margin: 10px 0 40px 0;
		}
	</style>
</body>

</html>
