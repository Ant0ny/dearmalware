jQuery(function($){

  $(".progress_line img").show();

  $(".status_line").html("<p><strong>Getting directories structure.</strong></p>").show();

  var data = {
    action:"get_structure"
  };

  $.ajax({
    method: "POST",
    url: './dear_ajax_scanner.php',
    data: data,
    success: function (res) {
      if (res != undefined){
        $(".progress_line img").hide();
        $(".status_line").append("<p><strong>We've got directories structure...<span class=\"green\">OK</span></strong></p>");

        $(".output").html(res.whatfound);
      }
    },
  }).then(function(){
    var data = {
      action:"check_viruses"
    };

    $(".progress_line img").show();

    $(".status_line").append("<p><strong>Scanning text content files for viruses.</strong></p>").show();

    $.ajax({
      method: "POST",
      url: './dear_ajax_scanner.php',
      data: data,
      success: function (res2) {
        if (res2 != undefined){
          $(".progress_line img").hide();

          if (res2.isfound != undefined && res2.isfound == true)
            $(".status_line").append("<p><strong>All files have been scanned up. We've found a dangerous code...<span class=\"red\">Warning</span></strong></p>");
          if (res2.isfound != undefined && res2.isfound == false)
            $(".status_line").append("<p><strong>All files have been scanned up, There's no dangerous code...<span class=\"green\">ОК</span></strong></p>");
          $(".output").append(res2.whatfound);
        }
      }
    });
  });
});
